<div align="center">
   <p align="center">
      <a href="https://ucode.world/en/" target="_blank">
         <img src="./public/project/ucode_it_academy_logo.svg" height="100px" alt="ucode_logo">
      </a>
   </p>

   <img src="./public/project/logo.png" width="200" />
   <h1 align="center">Flowy</h1>

<p align="center">
   <img src="https://img.shields.io/badge/TypeScript-3178C6?logo=typescript&logoColor=white" alt="TypeScript" />
   <img src="https://img.shields.io/badge/Node.js-339933?logo=nodedotjs&logoColor=white" alt="Node.js" />
   <img src="https://img.shields.io/badge/NestJS-E0234E?logo=nestjs&logoColor=white" alt="NestJS" />
   <img src="https://img.shields.io/badge/Express-000000?logo=express&logoColor=white" alt="Express" />
   <img src="https://img.shields.io/badge/MySQL-4479A1?logo=mysql&logoColor=white" alt="MySQL" />
   <img src="https://img.shields.io/badge/Prisma-2D3748?logo=prisma&logoColor=white" alt="Prisma" />
   <img src="https://img.shields.io/badge/Swagger-85EA2D?logo=swagger&logoColor=white" alt="Swagger" />
   <img src="https://img.shields.io/badge/Docker-2496ED?logo=docker&logoColor=white" alt="Docker" />
   <img src="https://img.shields.io/badge/Jest-C21325?logo=jest&logoColor=white" alt="Jest" />
   <img src="https://img.shields.io/badge/Faker.js-1565C0?logo=faker&logoColor=white" alt="Faker.js" />
   <img src="https://img.shields.io/badge/JWT-000000?logo=json-web-token&logoColor=white" alt="JSON Web Token" />
   <img src="https://img.shields.io/badge/Bcrypt-003087?logo=bcrypt&logoColor=white" alt="Bcrypt" />
   <img src="https://img.shields.io/badge/Passport-34E27A?logo=passport&logoColor=white" alt="Passport" />
   <img src="https://img.shields.io/badge/class_validator-FF6F61?logo=class-validator&logoColor=white" alt="class-validator" />
   <img src="https://img.shields.io/badge/class_transformer-FF6F61?logo=class-transformer&logoColor=white" alt="class-transformer" />
   <img src="https://img.shields.io/badge/Nodemailer-0095FF?logo=nodemailer&logoColor=white" alt="Nodemailer" />
   <img src="https://img.shields.io/badge/cookie_parser-000000?logo=cookiecutter&logoColor=white" alt="cookie-parser" />
   <img src="https://img.shields.io/badge/csurf-000000?logo=csurf&logoColor=white" alt="csurf" />
   <img src="https://img.shields.io/badge/Multer-2C3E50?logo=multer&logoColor=white" alt="Multer" />
   <img src="https://img.shields.io/badge/ESLint-4B32C3?logo=eslint&logoColor=white" alt="ESLint" />
   <img src="https://img.shields.io/badge/Prettier-F7B93E?logo=prettier&logoColor=black" alt="Prettier" />
</p>

   <h3>
      <p align="center">
         <sub><i>
            ucode connect webster "Flowy" is the project of ucode connect the Track FullStack programming bootcamp<br />
            lasting 6 weeks (May 5, 2025 - June 16, 2025),<br />where the NestJS with TypeScript and React with KonvaJS were used to develop the service for graphic design.<br /><br />
            The purpose: create a service for graphic design that allows every user without design skills to create and <br >
            process images using the whole cycle of Challenge Based Learning framework with a team.
         </i></sub>
      </p>
   </h3>
</div>



# ğŸ“‘ Table of Contents
- [ğŸ¨ About "Flowy" Platform](#-about-flowy-platform)
- [ğŸ§‘â€ğŸ’» Team](#-team)
- [ğŸŒŠ About "Flowy" Backend](#-about-flowy-backend)
- [ğŸ¯ Features and Functionality](#-features-and-functionality)
  - [ğŸ” Authentication & Authorization](#-authentication--authorization)
  - [ğŸ‘¥ User Management](#-user-management)
  - [ğŸ“§ Email System](#-email-system)
  - [ğŸ›¡ï¸ Security Features](#ï¸-security-features)
  - [ğŸ”§ API Documentation](#-api-documentation)
- [ğŸ§¶ Use case diagram](#-use-case-diagram)
- [ğŸ§² Activity diagram](#-activity-diagram)
  - [ğŸ‘¤ User Registaion](#-user-registaion)
  - [ğŸ Action History System](#-action-history-system)
  - [ğŸ“ File Export](#-file-export)
- [ğŸšš Deployment Diagram](#-deployment-diagram)
- [ğŸ“¦ Database Diagram](#-database-diagram)
- [âš™ï¸ Requirements and Dependencies](#ï¸-requirements-and-dependencies)
- [ğŸš€ How to Run the Solution](#-how-to-run-the-solution)
- [ğŸ‹ Docker](#-docker)
- [ğŸ“« Mailing Service](#-mailing-service)
  - [Gmail API Configuration](#gmail-api-configuration)
  - [Development Testing with Ethereal](#development-testing-with-ethereal)
  - [Email Templates](#email-templates)
- [ğŸ” REST API documentation](#-rest-api-documentation)
  - [API Features](#api-features)
- [ğŸ“¬ Postman](#-postman)
- [ğŸ“¦ Migrations](#-migrations)
  - [Migration Commands](#migration-commands)
  - [Seeding with fake data](#seeding-with-fake-data)



# ğŸ¨ About "Flowy" Platform

**Flowy** is a web-based graphic design platform that provides professional tools for creative design and image editing.

Create stunning visual effects with canvas drawing tools, advanced image processing features, layer management, and seamless workflows in your browser.

Built on modern web technologies, Flowy provides a comprehensive design experience with no experience required.

Here is a [link](https://docs.google.com/presentation/d/1bVpLPwLnU-Q78mZlx9RJoXGA6eXgI3dE/edit?usp=sharing&ouid=109902939512595211399&rtpof=true&sd=true) to the presentation file.</p>

![Description](https://github.com/user-attachments/assets/3ff0913a-3693-4e24-a695-58422583221b)
![Powerful Features](https://github.com/user-attachments/assets/40376653-2a0c-4f0e-81c5-e3d2c067c8ae)
![Compare possibilities](https://github.com/user-attachments/assets/ef2eaef7-b977-4d2c-997d-711b7df57f6a)
![Desktop View](https://github.com/user-attachments/assets/75e530bc-46e1-404a-9421-e5204752a5f1)
![Mobile and Tablet View](https://github.com/user-attachments/assets/8c4cd376-9df6-4aff-8ebd-161f438b4f31)
![Horizontal Tablet View](https://github.com/user-attachments/assets/ac377e60-f274-4335-9ac9-e0f611650683)
![Vertical Tablet View](https://github.com/user-attachments/assets/578fdbf0-f824-42da-838a-ea5a887e9471)



# ğŸ§‘â€ğŸ’» Team
<div>
    <table width="100%" border="0" cellpadding="1" align="center">  
        <tr>
            <td align="center">
                <a href="https://github.com/InessaRepeshko">
                    <img src="https://avatars.githubusercontent.com/u/80609514?v=4?s=100" width="150px;" alt="Inessa Repeshko"/><br />
                    <sub><b>Inessa Repeshko</b></sub>
                </a><br />
            </td>
            <td align="center">
                <a href="https://github.com/laskevych">
                    <img src="https://avatars.githubusercontent.com/u/29709878?v=4?s=100" width="150px;" alt="Andrew Laskevych"/><br />
                    <sub><b>Andrew Laskevych</b></sub>
                </a><br />
            </td>
        </tr>
    </table>
</div><br />



# ğŸŒŠ About "Flowy" Backend

"Flowy" Backend is built on Node.js with NestJS framework, utilizing TypeScript for type safety and maintainability. The platform integrates Prisma ORM with MySQL database, provides secure authentication with JWT tokens and Google OAuth, email services with Nodemailer, comprehensive API documentation with Swagger, containerization with Docker.

* NestJS provides a modular architecture with built-in TypeScript support, a decorator approach, and a dependency injection system.
* Prisma provides a type-safe approach to working with databases and automatic generation of TypeScript types based on the schema.
* JWT and Passport implement authentication with Google OAuth support. 
* Swagger provides automatic API documentation generation.
* MySQL guarantees reliable and efficient data storage with transaction support and scalability. 
* Docker ensures consistency in the development environment and simplifies deployment processes. 
* Postman optimizes the process of API testing and documentation creation.

The selected combination of technologies provides a balanced solution that optimally combines performance, reliability, and ease of development. 



# ğŸ¯ Features and Functionality

**Flowy Backend** provides a comprehensive set of features for modern web applications:

### ğŸ” Authentication & Authorization
- User Registration & Login with email verification
- Google OAuth 2.0 integration for social authentication
- JWT-based authentication with access and refresh tokens
- Password reset functionality with secure token validation
- Role-based access control for different user types
- Account email confirmation system
- Refresh token management with nonces for enhanced security

### ğŸ‘¥ User Management
- User profile management with avatar upload support
- Account settings and password management
- User dashboard with personalized content
- Secure password hashing using bcrypt
- Account ownership guards for secure access control

### ğŸ“§ Email System
- Email confirmation for account verification
- Password reset emails with secure links
- Ethereal email integration for development testing

### ğŸ›¡ï¸ Security Features
- CSRF protection with custom filters
- Request validation with comprehensive validators
- Input sanitization and type checking
- Secure password hashing using bcrypt
- Rate limiting and security headers
- Environment-based configuration management
- JWT token cleanup and security

### ğŸ”§ API Documentation
- Comprehensive Swagger documentation for all endpoints
- Interactive API explorer at `/api` endpoint
- Detailed request/response schemas
- API versioning and security documentation



# ğŸ§¶ Use case diagram
![Use case diagram](https://github.com/user-attachments/assets/2b4985d7-2b67-44b7-bb2d-6ee24aec5120)



# ğŸ§² Activity diagram

### ğŸ‘¤ User Registaion
![Activity diagram - User Registaion](https://github.com/user-attachments/assets/208d8322-0c4a-49fa-8f1b-6dd7024b2357)

### ğŸ Action History System
![Activity diagram - Action History System](https://github.com/user-attachments/assets/1c396bf0-5619-4cb4-9b83-c748d3d1dfaf)

### ğŸ“ File Export 
![Activity diagram - File Export](https://github.com/user-attachments/assets/30c6ae64-f19b-4bbd-a0bd-1881108e9b02)



# ğŸšš Deployment Diagram
![Deployment diagram](https://github.com/user-attachments/assets/851a2b61-1eba-4285-9748-30402830bd04)



# ğŸ“¦ Database Diagram
![Database Diagram](https://github.com/user-attachments/assets/0927ecb8-b356-479f-b1eb-2e8b92864018)



# âš™ï¸ Requirements and Dependencies

Before starting, ensure the required technologies are installed.

- **Node.JS** >= v22
- **NPM** >= v10
- **MySQL** >= 8.0



# ğŸš€ How to Run the Solution

In the examples of all commands in the text `<env>` is the name of the environment to perform the migration, e.g. `dev` or `prod`.

1. Clone this repository and move to the project directory:
   ```bash
   git clone <repository-url> flowy-backend
   cd flowy-backend
   ```
2. Install all dependencies:
   ```bash
   npm install
   ```
3. For development purposes use `dev` environment. Configure the database connection by copying the
   `.env.development.example` to a new file `.env.development`. After that put your MySQL credentials of root user:
    ```
    # Database Root Configuration
    DB_ROOT_HOST=localhost
    DB_ROOT_PORT=3306
    DB_ROOT_USER=root
    DB_ROOT_PASSWORD=root
    ```
   Also, new DB user `flowy_sql` will be created after executing the next command. Credentials of `flowy_sql` user can be changed:
    ```
    # Database App Configuration
    DB_APP_HOST=localhost
    DB_APP_PORT=3306
    DB_APP_USER=flowy_sql
    DB_APP_PASSWORD=securepass
    DB_APP_DATABASE=flowy
    ```
   For test purposes use `test` environment: create `.env.test` file by copying the `.env.test.example` file.
4. Run script for create databases and user:
   ```bash
   npm run setup:db
   ```
5. Run command to apply necessary migrations.
   ```bash
   npm run migrate
   ```
6. Run command to create prisma client:
   ```bash
   npm run migrate:generate
   ```
7. Run command to build the project:
   ```bash
   npm run build
   ```
8. Seeds help you fill your database with initial data for a presentation or project launch. To start creating test data, run the command:
    ```bash
    npm run migrate:seed
    ```
9. Start the server:
    ```bash
    npm run start:dev
    ```
10. Application will be launched on [http://localhost:8080/](http://localhost:8080/).



# ğŸ‹ Docker

Environment variables are taken from `.env.development` file. You can start containers with the command:
```bash
docker-compose --env-file .env.development up -d
```
To view a list of containers:
```bash
docker ps -a
```
To stop running containers:
```bash
docker-compose stop
```
To stop and delete containers, networks, and associated resources (with volumes):
```bash
docker-compose down -v
```



# ğŸ“« Mailing Service

The application uses **Gmail API** for production email delivery with OAuth2 authentication, providing reliable and secure email sending capabilities.

### Gmail API Configuration

The application is configured to use Gmail API for sending emails in production. To set up Gmail integration:

1. Google Cloud Console Setup:
   - Create a project in [Google Cloud Console](https://console.cloud.google.com/)
   - Enable Gmail API for your project
   - Create OAuth 2.0 credentials (Client ID and Client Secret)
   - Add your redirect URI for OAuth flow
2. Environment Configuration:
   Configure the following variables in your `.env.development` file:
   ```env
   GOOGLE_GMAIL_USER=your-gmail@gmail.com
   GOOGLE_GMAIL_API_REFRESH_TOKEN=your_refresh_token
   GOOGLE_CLIENT_ID=your_client_id
   GOOGLE_CLIENT_SECRET=your_client_secret
   GOOGLE_OAUTH_REDIRECT_URI=your_redirect_uri
   ```
3. OAuth2 Flow:
   - Use Google OAuth2 flow to obtain refresh token
   - The application automatically refreshes access tokens as needed

The application uses email services for user communication and verification processes.

### Development Testing with Ethereal
For development and testing purposes, you can use [Ethereal Email](https://ethereal.email/) - a fake SMTP service where messages are captured but never delivered.

Default test credentials you can find in [.env.development.example](.env.development.example):
* login: ```corrine.strosin80@ethereal.email```
* password: ```EEshmbDQ6mKBzprKVK```

### Email Templates
Email types supported:
- Account email confirmation
- Password reset notifications



# ğŸ” REST API documentation

The comprehensive API documentation is available at [http://localhost:8080/api](http://localhost:8080/api) or [https://flowy-photoshop.onrender.com/api](https://flowy-photoshop.onrender.com/api) and provides:

- **Interactive API Explorer**: Built with Swagger UI, allowing you to test endpoints directly in the browser
- **Complete Endpoint Coverage**: Documentation for all available REST endpoints including authentication and users
- **Security Documentation**: Clear indication of which endpoints require JWT authentication and CSRF tokens
- **Request/Response Schemas**: Detailed schema definitions with examples for all data structures
- **Error Response Documentation**: Comprehensive error codes and response formats

### API Features:
- **JWT Authentication**: Bearer token authentication for protected endpoints
- **CSRF Protection**: Cross-Site Request Forgery protection for state-changing operations
- **File Upload Support**: Endpoints for avatar uploads
- **Real-time Validation**: Request validation with detailed error messages



# ğŸ“¬ Postman

To use the predefined settings for Postman, import the file [flowy.postman_collection.json](/docs/flowy.postman_collection.json).

The collection includes comprehensive API endpoint definitions organized into categories such as:
- **Auth**: Authentication endpoints (login, register, password reset)
- **Users**: User management and profile operations

![postman_example](/docs/postman.png)



# ğŸ“¦ Migrations

### Migration Commands

1. Create new migration:
    ```bash
    npm run migrate:create --name <migration_name>
    ```
2. Apply migrations:
    ```bash
    npm run migrate
    ```
3. Generate Prisma client:
    ```bash
    npm run migrate:generate
    ```
4. Seed database with demo data:
    ```bash
    npm run migrate:seed
    ```
5. Reset and refresh database:
    ```bash
    npm run migrate:refresh
    ```

### ğŸ‘¤ Seeding with fake data

The seeding system creates comprehensive demo data including:
- Users with verified accounts
- Refresh token nonces for security testing
- Email templates and configurations

To fill the database with demo data of users and system entities, run the following command:
```bash
npm run migrate:seed
```
Here is the fake data for presentations.

User data for testing:
* full name:
   ```text
   Test User
   ```
* email:
  ```text
  test.user@flowy.com
  ```
All users have a password:
```text
Password123!$
```

---

Â© Inessa Repeshko. 2025
